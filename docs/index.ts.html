<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Source: index.ts</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Source: index.ts</h1>

    



    
    <section>
        <article>
            <pre class="prettyprint source linenums"><code>import {
    Market,
    contract,
    parentCollectionId,
    collateralToken,
} from "./constants";

/** 
 * @property {function} getPositionId
 * This function is called by clicking on an outcome. It gets the position Id for that outcome
 * @param {Market} market - the market object
 * @param {string} outcome - name of the outcome
 * @param {func} setPositionId - parent state setter for positionId
 * @param {func} setErrorMessage - parent state setter for errorMessage
 * @returns {string}  the positionId returned by the Conditional Tokens contract
 * */
export async function getPositionId({
    market,
    outcome,
    setPositionId,
    setErrorMessage,
}: {
    market: Market;
    outcome: string;
    setPositionId: React.Dispatch&lt;React.SetStateAction&lt;string>>;
    setErrorMessage: React.Dispatch&lt;React.SetStateAction&lt;string>>;
}): Promise&lt;string> {
    try {
        const outcomeArray: number[] = new Array(market.outcomes.length).fill(
            0,
        );
        const outcomeIndex: number = market.outcomes.indexOf(outcome);
        outcomeArray.splice(outcomeIndex, 1, 1);
        const binary: string = outcomeArray.reverse().join("");
        const indexSet: number = parseInt(binary, 2);
        const collectionId: string = await contract
            .getCollectionId(parentCollectionId, market.conditionId, indexSet);
            
        const positionId: string = await contract
            .getPositionId(collateralToken, collectionId);
            setPositionId(positionId);
        return positionId
    } catch (error) {
        setErrorMessage(error.message);
        return error.message;
    }
}


/** 
 * @property {function} getBalance
 * This function is called by clicking submit in the modal. It gets the balance of the provided address.
 * @param {string} address - should be customers Polymarket account address, not their wallet address
 * @param {string} positionId - the id for the position returned from getPositionId
 * @param {function} setBalance - component state setter for positionId
 * @param {function} setErrorMessage - parent state setter for errorMessage
 * @returns {string} - customer's balance for the positionId
 * */
export async function getBalance({
    address,
    positionId,
    setBalance,
    setErrorMessage,
}: {
    address: string;
    positionId: string;
    setBalance: React.Dispatch&lt;React.SetStateAction&lt;string | undefined>>;
    setErrorMessage: React.Dispatch&lt;React.SetStateAction&lt;string>>;
}): Promise&lt;string> {
    try {
        const balance: string = await contract
            .balanceOf(address, positionId);
       setBalance((+balance / 1000000).toFixed(6));
       return balance;
    } catch (error) {
         setErrorMessage(error.message);
         return (error.message)
    }
}

/** 
 * @property {function}searchMarkets
 * This function is called by typing in the search input. It searches market questions and descriptions for matches
 * @param {Array} object - the array of market objects fetched by getStaticProps from the api
 * @param {Array} properties - keys for the properties of the market objects
 * @param {string} query - the text coming from the search input
*  @returns {boolean} - value indicating if search query was found
 * */

export function searchMarkets&lt;data>(
    object: data,
    properties: Array&lt;keyof data>,
    query: string,
): boolean {
    if (query === "") {
        return true;
    }

    return properties.some((property) => {
        const value = object[property];
        if (typeof value === "string" || typeof value === "number") {
            return value.toString().toLowerCase().includes(query.toLowerCase());
        }
        return false;
    });
}</code></pre>
        </article>
    </section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Global</h3><ul><li><a href="global.html#getBalance">getBalance</a></li><li><a href="global.html#getPositionId">getPositionId</a></li><li><a href="global.html#searchMarkets">searchMarkets</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.6</a> on Sun Jan 17 2021 20:54:59 GMT-0600 (Central Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>
